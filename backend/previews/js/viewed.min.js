function getWindowHeight(){var e=0;"number"==typeof window.innerHeight?e=window.innerHeight:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(e=document.body.clientHeight);screen.availHeight,document.body.clientHeight;return e}var isDebug=window.location.href.indexOf("#johldebug")>0,$mktboxes=$(".marketing-item");isDebug&&$mktboxes.find("img").css("outline","solid 4px gray");var lastNotedScroll=(new Date).getTime(),lastScroll=(new Date).getTime(),viewTime=1e3,viewArea=.5,$window=$(window),scrollMon=function(){if(lastNotedScroll<lastScroll){lastNotedScroll=(new Date).getTime();var e=$window.scrollTop(),t=e+getWindowHeight();$mktboxes.each((function(){var i=$(this);if(1===i.data("viewed"))return!0;var n=i.height()*viewArea,o=i.offset().top,a=o+i.height(),l=0;o>=e?o+n<t&&(l=1):a-n>=e&&(l=1),i.data("visibility")!==l&&(i.data("visibility",l),0===l?i.data("vistimer")&&(clearTimeout(i.data("vistimer")),i.data("vistimer",!1),isDebug&&i.find("img").css("outline","solid 4px darkred")):i.data("vistimer")||(isDebug&&i.find("img").css("outline","solid 4px yellow"),i.data("vistimer",setTimeout((function(){i.data("viewed",1),$.ajax(i.find("a").first().attr("href")+"&is_view=1",{method:"POST"}).fail((function(){$.ajax(i.find("a").first().attr("href")+"&is_view=1&retry=1",{method:"POST"})})),isDebug&&i.find("img").css("outline","solid 4px darkgreen")}),viewTime))))}))}};$(document).on("scroll",(function(){lastScroll=(new Date).getTime()})),setInterval((function(){$mktboxes=$(".marketing-item")}),250);var boxTimer=setInterval(scrollMon,255);$(document).ready((function(){lastScroll=(new Date).getTime()})),$(window).load((function(){lastScroll=(new Date).getTime()}));